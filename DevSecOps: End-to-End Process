A practical reference for secure software delivery using GitHub, CI/CD, and cloud-native environments.

## 1. Developer IDE (Shift-Left Security)
ğŸ” Security Actions

Pre-commit hooks (secret scanning, linting, SAST-lite)

IDE security plugins

Snyk, SonarLint, GitHub Advanced Security extension

Dependency safety checks

mvn dependency-check

npm audit

Secure coding templates

Pre-enabled Spring Security, CSP headers, input validation

ğŸ“„ Example Pre-Commit Hook
- repo: https://github.com/zricethezav/gitleaks
  rev: v8.18.0
  hooks:
    - id: gitleaks

## 2. GitHub Repository Security
ğŸ”’ Essential Controls

Branch protection rules

Require PR reviews

Require passing SAST/SCA checks

Require signed commits

Secret scanning (GHAS)

Dependabot for automated upgrades

Restrict token scopes (repo-only, 7-day expiry)

âœ”ï¸ Branch Protection Example
main branch:
  - 1 mandatory reviewer
  - Required checks: Build, SAST, Dependency-Scan
  - Signed commits: enabled

## 3. GitHub Actions CI Pipeline (Build â†’ SAST â†’ SCA â†’ Testing)
ğŸ—ï¸ Pipeline Flow

Build

SAST (CodeQL/Semgrep)

SCA (Snyk, Dependabot)

Secret Scanning (Gitleaks)

Unit + Security tests

ğŸ”§ Sample GitHub Actions Workflow
name: CI-Security

on:
  push:
  pull_request:

jobs:
  build-security:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4

    - name: Build Project
      run: mvn clean package -DskipTests

    - name: Initialize CodeQL
      uses: github/codeql-action/init@v3
      with:
        languages: java

    - name: Run CodeQL
      uses: github/codeql-action/analyze@v3

    - name: Gitleaks Secret Scan
      uses: zricethezav/gitleaks-action@v2

    - name: Snyk Dependency Scan
      uses: snyk/actions/maven@master
      env:
        SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}

## 4. Artifact Hardening (Containers + Signing)
ğŸ” Security Must-Haves

Non-root containers

Multi-stage Docker builds

Container vulnerability scanning (Trivy/Grype)

Signing artifacts (Cosign/Sigstore)

ğŸ³ Example Dockerfile
FROM maven:3.9 AS builder
WORKDIR /build
COPY . .
RUN mvn package

FROM eclipse-temurin:17
USER 1000
COPY --from=builder /build/target/app.jar /app.jar
ENTRYPOINT ["java", "-jar", "/app.jar"]

ğŸ” Trivy Scan Step
- name: Trivy Scan
  uses: aquasecurity/trivy-action@master

## 5. CD Deployment Security
ğŸ›¡ï¸ Controls in Delivery Pipeline

IaC scanning (Terraform/Helm) using Checkov

GitHub OIDC â†’ Secrets from Vault (no static secrets)

Policy-as-Code (OPA/Gatekeeper)

Deployment gates based on severity thresholds

âœ”ï¸ Checkov Example
- name: IaC Scan
  uses: bridgecrewio/checkov-action@master

## 6. Runtime Security (Kubernetes / VM)
ğŸ” Core Controls

Admission controllers:

No root users

Read-only filesystem

Approved images only

mTLS between services (Istio/Linkerd)

Runtime threat detection (Falco)

ğŸ›¡ï¸ Example Falco Rules
Detect reverse shell:
  - container running 'bash -i'
  - unexpected outbound traffic

## 7. Monitoring, Alerting, and Continuous Feedback
ğŸ“ˆ Continuous Monitoring

Application logs â†’ Elastic, Splunk, Loki

GitHub audit logs

Cloud provider audit logs (GCP/AWS)

Kubernetes audit logs

ğŸš¨ Alerts to Configure

Excessive failed logins

New high-severity CVEs in dependencies

Unauthorized GitHub PAT creation

Drift in container image hash

Unexpected network egress

## 8. Text-Based DevSecOps Pipeline (ASCII Diagram)
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚        Developer IDE         â”‚
 â”‚  - Pre-commit hooks          â”‚
 â”‚  - Secrets scan              â”‚
 â”‚  - SAST in IDE               â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚ git push
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚        GitHub Repo           â”‚
 â”‚  - Branch protection         â”‚
 â”‚  - Dependabot                â”‚
 â”‚  - Secret scanning           â”‚
 â”‚  - Commit signing            â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         Triggers GitHub Actions
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚         CI Pipeline          â”‚
 â”‚  - Build                     â”‚
 â”‚  - SAST (CodeQL/Semgrep)     â”‚
 â”‚  - SCA (Snyk/Dependabot)     â”‚
 â”‚  - Secrets scan (Gitleaks)   â”‚
 â”‚  - Tests                     â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚ artifact
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚  Artifact Hardening          â”‚
 â”‚  - Docker build              â”‚
 â”‚  - Non-root container        â”‚
 â”‚  - Trivy scan                â”‚
 â”‚  - Cosign signing            â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚ deploy
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚     CD / Deployment          â”‚
 â”‚  - IaC scan (Checkov)        â”‚
 â”‚  - OPA/Gatekeeper policies   â”‚
 â”‚  - Vault secret injection    â”‚
 â”‚  - ArgoCD / GitOps           â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚ running
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚     Runtime Security         â”‚
 â”‚  - Falco                     â”‚
 â”‚  - Network policies          â”‚
 â”‚  - Pod Security Standards    â”‚
 â”‚  - mTLS                      â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚ telemetry
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚   Monitoring & Feedback      â”‚
 â”‚  - SIEM alerts               â”‚
 â”‚  - GitHub audit logs         â”‚
 â”‚  - Metrics (Prometheus)      â”‚
 â”‚  - Threat modeling updates   â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
